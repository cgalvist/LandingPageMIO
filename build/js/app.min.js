angular.module("app",["ngMaterial","ui.router"]).config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("webCG/inicio"),$stateProvider.state("webCG",{url:"/webCG",abstract:!0,templateUrl:"templates/menu.html",controller:"toolbarCtrl"}).state("webCG.inicio",{url:"/inicio",views:{contenidoMenu:{templateUrl:"templates/inicio.html",controller:"inicioCtrl"}}}).state("webCG.grupos",{url:"/grupos",views:{contenidoMenu:{templateUrl:"templates/grupos/grupos.html"}}}).state("webCG.acerca",{url:"/acerca",views:{contenidoMenu:{templateUrl:"templates/acerca.html",controller:"acercaCtrl"}}}).state("webCG.maquinaria",{url:"/grupos/maquinaria",views:{contenidoMenu:{templateUrl:"templates/grupos/maquinaria/inicio.html",controller:"maquinariaCtrl"}}}).state("webCG.invernaderos",{url:"/grupos/invernaderos",views:{contenidoMenu:{templateUrl:"templates/grupos/invernaderos/inicio.html",controller:"invernaderosCtrl"}}}).state("webCG.formaletas",{url:"/grupos/formaletas",views:{contenidoMenu:{templateUrl:"templates/grupos/formaletas/inicio.html",controller:"formaletasCtrl"}}})});var last={bottom:!0,top:!1,left:!1,right:!0};angular.module("app").controller("toolbarCtrl",["$scope","$timeout","$mdSidenav",function($scope,$timeout,$mdSidenav){function debounce(func,wait,context){var timer;return function(){var context=$scope,args=Array.prototype.slice.call(arguments);$timeout.cancel(timer),timer=$timeout(function(){timer=void 0,func.apply(context,args)},wait||10)}}function buildDelayedToggler(navID){return debounce(function(){$mdSidenav(navID).toggle()},200)}$scope.toggleLeft=buildDelayedToggler("left"),$scope.close=function(){$mdSidenav("left").close()}}]).controller("inicioCtrl",function($scope){}).controller("acercaCtrl",function($scope){}).controller("maquinariaCtrl",function($scope){}).controller("invernaderosCtrl",function($scope,$mdToast,EnviarCorreo){function sanitizePosition(){var current=$scope.toastPosition;current.bottom&&last.top&&(current.top=!1),current.top&&last.bottom&&(current.bottom=!1),current.right&&last.left&&(current.left=!1),current.left&&last.right&&(current.right=!1),last=angular.extend({},current)}$scope.invernadero={formulario:"invernadero",medidas:{unidades:"metros"}},$scope.toastPosition=angular.extend({},last),$scope.getToastPosition=function(){return sanitizePosition(),Object.keys($scope.toastPosition).filter(function(pos){return $scope.toastPosition[pos]}).join(" ")},$scope.mensajeSimple=function(mensaje){var pinTo=$scope.getToastPosition();$mdToast.show($mdToast.simple().textContent(mensaje).position(pinTo).hideDelay(3e3))},$scope.enviar=function(){var datosFormulario=JSON.stringify($scope.invernadero);EnviarCorreo.enviar(datosFormulario).then(function(data){$scope.mensajeSimple("Formulario enviado exitosamente")}).catch(function(err){console.log(err)})}}).controller("formaletasCtrl",function($scope,$mdToast,EnviarCorreo,ListaDatos,ListaMedidas){function sanitizePosition(){var current=$scope.toastPosition;current.bottom&&last.top&&(current.top=!1),current.top&&last.bottom&&(current.bottom=!1),current.right&&last.left&&(current.left=!1),current.left&&last.right&&(current.right=!1),last=angular.extend({},current)}$scope.formaleta={formulario:"formaleta",medidas:{unidades:"mm"}},$scope.listaMedidas=[],$scope.listaDatos=[],ListaMedidas.getAll().then(function(data){$scope.listaMedidas=data}).catch(function(err){console.log(err)}),ListaDatos.getAll().then(function(data){$scope.listaDatos=data}).catch(function(err){console.log(err)}),$scope.toastPosition=angular.extend({},last),$scope.getToastPosition=function(){return sanitizePosition(),Object.keys($scope.toastPosition).filter(function(pos){return $scope.toastPosition[pos]}).join(" ")},$scope.mensajeSimple=function(mensaje){var pinTo=$scope.getToastPosition();$mdToast.show($mdToast.simple().textContent(mensaje).position(pinTo).hideDelay(3e3))},$scope.enviar=function(){var datosFormulario=JSON.stringify($scope.formaleta);EnviarCorreo.enviar(datosFormulario).then(function(data){$scope.mensajeSimple("Formulario enviado exitosamente")}).catch(function(err){console.log(err)})}});var ipServer="/static/data",backEndURL;backEndURL="http://backend.compgrafica20162.tk/",angular.module("app").factory("ListaDatos",function($http,$q){function getAll(){var deferred=$q.defer();return $http({method:"GET",url:ipServer+"/listaDatos.json"}).success(function(data){deferred.resolve(data)}).error(function(error){deferred.reject(error)}),deferred.promise}return{getAll:getAll,get:function(itemId){for(var listaDatos=getAll(),i=0;i<listaDatos.length;i++)if(listaDatos[i].id===parseInt(itemId))return listaDatos[i];return null}}}).factory("ListaMedidas",function($http,$q){function getAll(){var deferred=$q.defer();return $http({method:"GET",url:ipServer+"/listaMedidas.json"}).success(function(data){deferred.resolve(data)}).error(function(error){deferred.reject(error)}),deferred.promise}return{getAll:getAll,get:function(itemId){for(var listaMedidas=getAll(),i=0;i<listaMedidas.length;i++)if(listaMedidas[i].id===parseInt(itemId))return listaMedidas[i];return null}}}).factory("EnviarCorreo",function($http,$q){function enviar(mensaje){var deferred=$q.defer();return $http({method:"POST",url:backEndURL+"send-json-to-office",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"message="+mensaje}).success(function(data){deferred.resolve(data)}).error(function(error){deferred.reject(error)}),deferred.promise}return{enviar:function(mensaje){return enviar(mensaje)}}});